name: Update WhatsApp Lists

on:
  schedule:
    - cron: '0 */6 * * *'  # ĞšĞ°Ğ¶Ğ´Ñ‹Ğµ 6 Ñ‡Ğ°ÑĞ¾Ğ²
  workflow_dispatch:

jobs:
  update:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    
    steps:
    - name: ğŸ“¥ Checkout repository
      uses: actions/checkout@v3
    
    - name: âš™ï¸ Setup environment
      run: |
        sudo apt-get update
        sudo apt-get install -y dnsutils curl
    
    - name: ğŸ” Create WhatsApp lists
      run: |
        mkdir -p lists
        
        # ĞŸÑ€Ğ¾ÑÑ‚Ñ‹Ğµ ÑÑ‚Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ ÑĞ¿Ğ¸ÑĞºĞ¸
        cat > lists/domains.txt << 'DOMAINS'
# WhatsApp domains (auto-updated)
whatsapp.com
www.whatsapp.com
web.whatsapp.com
api.whatsapp.com
chat.whatsapp.com
call.whatsapp.com
voice.whatsapp.com
beta.whatsapp.com
s.whatsapp.net
static.whatsapp.net
mmg.whatsapp.net
mmi.whatsapp.net
mms.whatsapp.net
v.whatsapp.net
voip.whatsapp.com
facebook.com
www.facebook.com
fbcdn.net
# Generated: $(date)
DOMAINS
        
        cat > lists/cidr.txt << 'CIDR'
# Meta/WhatsApp IP ranges
31.13.24.0/21
31.13.64.0/18
157.240.0.0/16
129.134.0.0/16
173.252.64.0/18
# Generated: $(date)
CIDR
        
        echo "Created:"
        echo "  Domains: $(wc -l < lists/domains.txt)"
        echo "  CIDR: $(wc -l < lists/cidr.txt)"
    
    - name: ğŸ“ Commit and push
      run: |
        git config --global user.name "GitHub Actions"
        git config --global user.email "actions@github.com"
        
        git add lists/
        if git diff --cached --quiet; then
          echo "No changes to commit"
        else
          git commit -m "Update WhatsApp lists: $(date '+%Y-%m-%d %H:%M:%S')"
          git push
        fi
